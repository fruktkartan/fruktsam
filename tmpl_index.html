<!doctype html>
<html lang=sv>
<head>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Historik - Fruktkartan</title>
<style>
 body {
   font-family: sans;
   font-size: 13pt;
   background-color: #fafafa;
 }
 .change {
   padding: 0.5em 0 0.5em 0;
   margin: 0;
 }
 .change:nth-child(odd) {
   background-color: #f8f0e3;
 }
 .change:nth-child(even) {
 }
 .op, .changetime {
  font-family: monospace;
  font-size: 12pt;
 }
 .op {
  font-weight: bold;
 }
 .type {
   font-style: italic;
 }
 .near {
   font-size: 11pt;
 }
 .readable {
   max-width: 32em;
 }
 p.date {
   border-top: 2px solid grey;
 }
 .bread {
   display: inline-block; /* to set max-width */
   font-size: smaller;
   max-width: 32em;
 }
 .delete {
   color: red;
 }
 .insert {
   color: green;
 }
 .update {
   color: darkorange;
 }
 .old {
   text-decoration: line-through;
   filter: contrast(25%);
   text-decoration-color: black;
   text-decoration-thickness: 2px;
 }
 .added {
   border: 2px solid green;
 }
  ins, del {
    /* get rid of default underline/overstrike for these (we have colors) */
    text-decoration: none;
  }
</style>
</head>
<body>

<p class="readable">
  Det finns {{ .Trees.Count }} trÃ¤d pÃ¥ <a href="https://fruktkartan.se/">fruktkartan.se</a> ({{ .Now }}).
</p>

<p class="readable">
  Nedan fÃ¶ljer senaste {{ .History.SinceDays }} dagarnas Ã¤ndringar. Under perioden
  lades {{ .History.Inserts }} trÃ¤d till och {{ .History.Deletes }} togs bort
  (netto {{ .History.Net }}). {{ .History.Updates }} redigeringar gjordes.
</p>

{{ $lastDate := "" }}

{{ range .History.Entries }}

{{ if ne $lastDate .ChangeAt.Date }}
  <p class="date readable">{{ .ChangeAt.Date }}</p>
  {{ $lastDate = .ChangeAt.Date }}
{{ end }}

<div class="change">
  <span class="changetime">{{ .ChangeAt.TimeStr }}</span>

  {{ if eq .ChangeOp "DELETE" }}
  <span class="op delete">bort</span>
  <span class="type">{{ .Type }}</span>
  <span class="key">[{{ .Key }}]</span>
  <span class="near">â€” <a href="{{ .GeoURL }}" target="_blank" rel="noopener">nÃ¤ra</a> {{ .Address }}</span>
  <br/>
  <span class="bread old">beskrivning: {{ .Desc }}</span>
  <br/>
  <span class="bread">senast redigerat: {{ .At }}</span>
  {{ if ne .Img.String "" }}<span class="img old"><a href="{{ .Img }}" target="_blank" rel="noopener">ðŸ“·</a></span>{{ end }}
  {{ end }}

  {{ if eq .ChangeOp "INSERT" }}
  <span class="op insert">nytt</span>
  <span class="type"><a href="https://fruktkartan.se/#/t/{{ .KeyNew }}" target="_blank" rel="noopener">{{ .TypeNew }}</a></span>
  <span class="near">â€” <a href="{{ .GeoURLNew }}" target="_blank" rel="noopener">nÃ¤ra</a> {{ .AddressNew }}</span>
  <br/>
  <span class="bread">beskrivning: {{ .DescNew }}</span>
  {{ if ne .ImgNew.String "" }}<span class="img"><a href="{{ .ImgNew }}" target="_blank" rel="noopener">ðŸ“·</a></span>{{ end }}
  {{ end }}

  {{ if eq .ChangeOp "UPDATE" }}
  <span class="op update">red.</span>
  <span class="type"><a href="https://fruktkartan.se/#/t/{{ .KeyNew }}" target="_blank" rel="noopener">{{ .TypeNew }}</a></span>
  {{ if ne .Type .TypeNew }}<span class="old">typ:{{ .Type }}</span>{{ end }}
  <span class="near">â€” <a href="{{ .GeoURLNew }}" target="_blank" rel="noopener">nÃ¤ra</a> {{ .AddressNew }}</span>
  <br/>
  <span class="bread">beskrivning: {{ .DescDiff }}</span>
  <br/>
  <span class="bread">senast redigerat: {{ .At }}</span>
    {{ if ne .ImgNew.String "" }}
      {{ if ne .Img.String "" }}
        {{ if ne .Img .ImgNew }}
          <span class="img old"><a href="{{ .Img }}" target="_blank" rel="noopener">ðŸ“·</a></span>
        {{ end }}
        <span class="img"><a href="{{ .ImgNew }}" target="_blank" rel="noopener">ðŸ“·</a></span>
      {{ else }}
        <span class="img added"><a href="{{ .ImgNew }}" target="_blank" rel="noopener">ðŸ“·</a></span>
      {{ end }}
    {{ else }}
      {{ if ne .Img.String "" }}
        <span class="img old"><a href="{{ .Img }}" target="_blank" rel="noopener">ðŸ“·</a></span>
      {{ end }}
    {{ end }}
  {{ end }}
</div>

{{ end }}

</body>
</html>
